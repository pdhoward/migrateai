[{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "RULE",
    "name": "MAIN-PARA",
    "paragraph": "       MAIN-PARA.\n           SET ERR-FLG-OFF TO TRUE\n           SET TRANSACT-NOT-EOF TO TRUE\n           SET SEND-ERASE-YES TO TRUE\n           MOVE SPACES TO WS-MESSAGE\n                          ERRMSGO OF CORPT0AO\n           IF EIBCALEN = 0\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n               PERFORM RETURN-TO-PREV-SCREEN\n           ELSE\n               MOVE DFHCOMMAREA(1:EIBCALEN) TO CARDDEMO-COMMAREA\n               IF NOT CDEMO-PGM-REENTER\n                   SET CDEMO-PGM-REENTER    TO TRUE\n                   MOVE LOW-VALUES          TO CORPT0AO\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n               ELSE\n                   PERFORM RECEIVE-TRNRPT-SCREEN\n                   EVALUATE EIBAID\n                       WHEN DFHENTER\n                           PERFORM PROCESS-ENTER-KEY\n                       WHEN DFHPF3\n                           MOVE 'COMEN01C' TO CDEMO-TO-PROGRAM\n                           PERFORM RETURN-TO-PREV-SCREEN\n                       WHEN OTHER\n                           MOVE 'Y'                       TO WS-ERR-FLG\n                           MOVE -1       TO MONTHLYL OF CORPT0AI\n                           MOVE CCDA-MSG-INVALID-KEY      TO WS-MESSAGE\n                           PERFORM SEND-TRNRPT-SCREEN\n                   END-EVALUATE\n               END-IF\n           END-IF\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "RULE",
    "name": "PROCESS-ENTER-KEY",
    "paragraph": "       PROCESS-ENTER-KEY.\n           DISPLAY 'PROCESS ENTER KEY'\n           EVALUATE TRUE\n               WHEN MONTHLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Monthly'   TO WS-REPORT-NAME\n                   MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n                   MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY\n                   MOVE WS-CURDATE-MONTH    TO WS-START-DATE-MM\n                   MOVE '01'                TO WS-START-DATE-DD\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n                   MOVE 1              TO WS-CURDATE-DAY\n                   ADD 1               TO WS-CURDATE-MONTH\n                   IF WS-CURDATE-MONTH > 12\n                       ADD 1           TO WS-CURDATE-YEAR\n                       MOVE 1          TO WS-CURDATE-MONTH\n                   END-IF\n                   COMPUTE WS-CURDATE-N = FUNCTION DATE-OF-INTEGER(\n                           FUNCTION INTEGER-OF-DATE(WS-CURDATE-N) - 1)\n                   MOVE WS-CURDATE-YEAR     TO WS-END-DATE-YYYY\n                   MOVE WS-CURDATE-MONTH    TO WS-END-DATE-MM\n                   MOVE WS-CURDATE-DAY      TO WS-END-DATE-DD\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n                   PERFORM SUBMIT-JOB-TO-INTRDR\n               WHEN YEARLYI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   MOVE 'Yearly'   TO WS-REPORT-NAME\n                   MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n                   MOVE WS-CURDATE-YEAR     TO WS-START-DATE-YYYY\n                                               WS-END-DATE-YYYY\n                   MOVE '01'                TO WS-START-DATE-MM\n                                               WS-START-DATE-DD\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n                   MOVE '12'                TO WS-END-DATE-MM\n                   MOVE '31'                TO WS-END-DATE-DD\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n                   PERFORM SUBMIT-JOB-TO-INTRDR\n               WHEN CUSTOMI OF CORPT0AI NOT = SPACES AND LOW-VALUES\n                   EVALUATE TRUE\n                       WHEN SDTMMI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Month can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN SDTDDI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Day can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTDDL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN SDTYYYYI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'Start Date - Year can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTYYYYL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTMMI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Month can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTDDI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Day can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTDDL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN EDTYYYYI OF CORPT0AI = SPACES OR\n                                                   LOW-VALUES\n                           MOVE 'End Date - Year can NOT be empty...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTYYYYL OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       WHEN OTHER\n                           CONTINUE\n                   END-EVALUATE\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (SDTMMI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO SDTMMI OF CORPT0AI\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (SDTDDI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO SDTDDI OF CORPT0AI\n                   COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C\n                                           (SDTYYYYI OF CORPT0AI)\n                   MOVE WS-NUM-9999      TO SDTYYYYI OF CORPT0AI\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (EDTMMI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO EDTMMI OF CORPT0AI\n                   COMPUTE WS-NUM-99 = FUNCTION NUMVAL-C\n                                         (EDTDDI OF CORPT0AI)\n                   MOVE WS-NUM-99      TO EDTDDI OF CORPT0AI\n                   COMPUTE WS-NUM-9999 = FUNCTION NUMVAL-C\n                                           (EDTYYYYI OF CORPT0AI)\n                   MOVE WS-NUM-9999      TO EDTYYYYI OF CORPT0AI\n                   IF SDTMMI OF CORPT0AI IS NOT NUMERIC OR\n                      SDTMMI OF CORPT0AI > '12'\n                       MOVE 'Start Date - Not a valid Month...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTMML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n                   IF SDTDDI OF CORPT0AI IS NOT NUMERIC OR\n                      SDTDDI OF CORPT0AI > '31'\n                       MOVE 'Start Date - Not a valid Day...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTDDL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n                   IF SDTYYYYI OF CORPT0AI IS NOT NUMERIC\n                       MOVE 'Start Date - Not a valid Year...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO SDTYYYYL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n                   IF EDTMMI OF CORPT0AI IS NOT NUMERIC OR\n                      EDTMMI OF CORPT0AI > '12'\n                       MOVE 'End Date - Not a valid Month...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTMML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n                   IF EDTDDI OF CORPT0AI IS NOT NUMERIC OR\n                      EDTDDI OF CORPT0AI > '31'\n                       MOVE 'End Date - Not a valid Day...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTDDL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n                   IF EDTYYYYI OF CORPT0AI IS NOT NUMERIC\n                       MOVE 'End Date - Not a valid Year...'\n                         TO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO EDTYYYYL OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n                   END-IF\n                   MOVE SDTYYYYI OF CORPT0AI TO WS-START-DATE-YYYY\n                   MOVE SDTMMI   OF CORPT0AI TO WS-START-DATE-MM\n                   MOVE SDTDDI   OF CORPT0AI TO WS-START-DATE-DD\n                   MOVE EDTYYYYI OF CORPT0AI TO WS-END-DATE-YYYY\n                   MOVE EDTMMI   OF CORPT0AI TO WS-END-DATE-MM\n                   MOVE EDTDDI   OF CORPT0AI TO WS-END-DATE-DD\n                   MOVE WS-START-DATE        TO CSUTLDTC-DATE\n                   MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n                   MOVE SPACES               TO CSUTLDTC-RESULT\n                   CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                           CSUTLDTC-DATE-FORMAT\n                                           CSUTLDTC-RESULT\n                   IF CSUTLDTC-RESULT-SEV-CD = '0000'\n                       CONTINUE\n                   ELSE\n                       IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                           MOVE 'Start Date - Not a valid date...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO SDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       END-IF\n                   END-IF\n                   MOVE WS-END-DATE          TO CSUTLDTC-DATE\n                   MOVE WS-DATE-FORMAT       TO CSUTLDTC-DATE-FORMAT\n                   MOVE SPACES               TO CSUTLDTC-RESULT\n                   CALL 'CSUTLDTC' USING   CSUTLDTC-DATE\n                                           CSUTLDTC-DATE-FORMAT\n                                           CSUTLDTC-RESULT\n                   IF CSUTLDTC-RESULT-SEV-CD = '0000'\n                       CONTINUE\n                   ELSE\n                       IF CSUTLDTC-RESULT-MSG-NUM NOT = '2513'\n                           MOVE 'End Date - Not a valid date...'\n                             TO WS-MESSAGE\n                           MOVE 'Y'     TO WS-ERR-FLG\n                           MOVE -1       TO EDTMML OF CORPT0AI\n                           PERFORM SEND-TRNRPT-SCREEN\n                       END-IF\n                   END-IF\n                   MOVE WS-START-DATE       TO PARM-START-DATE-1\n                                               PARM-START-DATE-2\n                   MOVE WS-END-DATE         TO PARM-END-DATE-1\n                                               PARM-END-DATE-2\n                   MOVE 'Custom'   TO WS-REPORT-NAME\n                   IF NOT ERR-FLG-ON\n                       PERFORM SUBMIT-JOB-TO-INTRDR\n                   END-IF\n               WHEN OTHER\n                   MOVE 'Select a report type to print report...' TO\n                                   WS-MESSAGE\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n           END-EVALUATE\n           IF NOT ERR-FLG-ON\n               PERFORM INITIALIZE-ALL-FIELDS\n               MOVE DFHGREEN           TO ERRMSGC  OF CORPT0AO\n               STRING WS-REPORT-NAME   DELIMITED BY SPACE\n                 ' report submitted for printing ...'\n                                       DELIMITED BY SIZE\n                 INTO WS-MESSAGE\n               MOVE -1       TO MONTHLYL OF CORPT0AI\n               PERFORM SEND-TRNRPT-SCREEN\n           END-IF.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "RULE",
    "name": "SUBMIT-JOB-TO-INTRDR",
    "paragraph": "       SUBMIT-JOB-TO-INTRDR.\n           IF CONFIRMI OF CORPT0AI = SPACES OR LOW-VALUES\n               STRING\n                 'Please confirm to print the '\n                                   DELIMITED BY SIZE\n                 WS-REPORT-NAME    DELIMITED BY SPACE\n                 ' report...'      DELIMITED BY SIZE\n                 INTO WS-MESSAGE\n               MOVE 'Y'     TO WS-ERR-FLG\n               MOVE -1       TO CONFIRML OF CORPT0AI\n               PERFORM SEND-TRNRPT-SCREEN\n           END-IF\n           IF NOT ERR-FLG-ON\n               EVALUATE TRUE\n                   WHEN CONFIRMI OF CORPT0AI = 'Y' OR 'y'\n                       CONTINUE\n                   WHEN CONFIRMI OF CORPT0AI = 'N' OR 'n'\n                       PERFORM INITIALIZE-ALL-FIELDS\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       PERFORM SEND-TRNRPT-SCREEN\n                   WHEN OTHER\n                       STRING\n                         '\"'               DELIMITED BY SIZE\n                         CONFIRMI OF CORPT0AI    DELIMITED BY SPACE\n                         '\" is not a valid value to confirm...'\n                                           DELIMITED BY SIZE\n                         INTO WS-MESSAGE\n                       MOVE 'Y'     TO WS-ERR-FLG\n                       MOVE -1       TO CONFIRML OF CORPT0AI\n                       PERFORM SEND-TRNRPT-SCREEN\n               END-EVALUATE\n               SET END-LOOP-NO TO TRUE\n               PERFORM VARYING WS-IDX FROM 1 BY 1 UNTIL WS-IDX > 1000 OR\n                                      END-LOOP-YES  OR ERR-FLG-ON\n                   MOVE JOB-LINES(WS-IDX) TO JCL-RECORD\n                   IF JCL-RECORD = '/*EOF' OR\n                      JCL-RECORD = SPACES OR LOW-VALUES\n                       SET END-LOOP-YES TO TRUE\n                   END-IF\n                   PERFORM WIRTE-JOBSUB-TDQ\n               END-PERFORM\n           END-IF.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "RULE",
    "name": "WIRTE-JOBSUB-TDQ",
    "paragraph": "       WIRTE-JOBSUB-TDQ.\n           EXEC CICS WRITEQ TD\n             QUEUE ('JOBS')\n             FROM (JCL-RECORD)\n             LENGTH (LENGTH OF JCL-RECORD)\n             RESP(WS-RESP-CD)\n             RESP2(WS-REAS-CD)\n           END-EXEC.\n           EVALUATE WS-RESP-CD\n               WHEN DFHRESP(NORMAL)\n                   CONTINUE\n               WHEN OTHER\n                   DISPLAY 'RESP:' WS-RESP-CD 'REAS:' WS-REAS-CD\n                   MOVE 'Y'     TO WS-ERR-FLG\n                   MOVE 'Unable to Write TDQ (JOBS)...' TO\n                                   WS-MESSAGE\n                   MOVE -1       TO MONTHLYL OF CORPT0AI\n                   PERFORM SEND-TRNRPT-SCREEN\n           END-EVALUATE.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "NON-RULE",
    "name": "RETURN-TO-PREV-SCREEN",
    "paragraph": "       RETURN-TO-PREV-SCREEN.\n           IF CDEMO-TO-PROGRAM = LOW-VALUES OR SPACES\n               MOVE 'COSGN00C' TO CDEMO-TO-PROGRAM\n           END-IF\n           MOVE WS-TRANID    TO CDEMO-FROM-TRANID\n           MOVE WS-PGMNAME   TO CDEMO-FROM-PROGRAM\n           MOVE ZEROS        TO CDEMO-PGM-CONTEXT\n           EXEC CICS\n               XCTL PROGRAM(CDEMO-TO-PROGRAM)\n               COMMAREA(CARDDEMO-COMMAREA)\n           END-EXEC.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "RULE",
    "name": "SEND-TRNRPT-SCREEN",
    "paragraph": "       SEND-TRNRPT-SCREEN.\n           PERFORM POPULATE-HEADER-INFO\n           MOVE WS-MESSAGE TO ERRMSGO OF CORPT0AO\n           IF SEND-ERASE-YES\n               EXEC CICS SEND\n                         MAP('CORPT0A')\n                         MAPSET('CORPT00')\n                         FROM(CORPT0AO)\n                         ERASE\n                         CURSOR\n               END-EXEC\n           ELSE\n               EXEC CICS SEND\n                         MAP('CORPT0A')\n                         MAPSET('CORPT00')\n                         FROM(CORPT0AO)\n                         CURSOR\n               END-EXEC\n           END-IF.\n           GO TO RETURN-TO-CICS.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "NON-RULE",
    "name": "RETURN-TO-CICS",
    "paragraph": "       RETURN-TO-CICS.\n           EXEC CICS RETURN\n                     TRANSID (WS-TRANID)\n                     COMMAREA (CARDDEMO-COMMAREA)\n           END-EXEC.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "NON-RULE",
    "name": "RECEIVE-TRNRPT-SCREEN",
    "paragraph": "       RECEIVE-TRNRPT-SCREEN.\n           EXEC CICS RECEIVE\n                     MAP('CORPT0A')\n                     MAPSET('CORPT00')\n                     INTO(CORPT0AI)\n                     RESP(WS-RESP-CD)\n                     RESP2(WS-REAS-CD)\n           END-EXEC.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "NON-RULE",
    "name": "POPULATE-HEADER-INFO",
    "paragraph": "       POPULATE-HEADER-INFO.\n           MOVE FUNCTION CURRENT-DATE  TO WS-CURDATE-DATA\n           MOVE CCDA-TITLE01           TO TITLE01O OF CORPT0AO\n           MOVE CCDA-TITLE02           TO TITLE02O OF CORPT0AO\n           MOVE WS-TRANID              TO TRNNAMEO OF CORPT0AO\n           MOVE WS-PGMNAME             TO PGMNAMEO OF CORPT0AO\n           MOVE WS-CURDATE-MONTH       TO WS-CURDATE-MM\n           MOVE WS-CURDATE-DAY         TO WS-CURDATE-DD\n           MOVE WS-CURDATE-YEAR(3:2)   TO WS-CURDATE-YY\n           MOVE WS-CURDATE-MM-DD-YY    TO CURDATEO OF CORPT0AO\n           MOVE WS-CURTIME-HOURS       TO WS-CURTIME-HH\n           MOVE WS-CURTIME-MINUTE      TO WS-CURTIME-MM\n           MOVE WS-CURTIME-SECOND      TO WS-CURTIME-SS\n           MOVE WS-CURTIME-HH-MM-SS    TO CURTIMEO OF CORPT0AO.\n"
},
{
    "client": "AWS",
    "application": "CARDDEMO",
    "program": "CORPT00C.COB",
    "kind": "NON-RULE",
    "name": "INITIALIZE-ALL-FIELDS",
    "paragraph": "       INITIALIZE-ALL-FIELDS.\n           MOVE -1              TO MONTHLYL OF CORPT0AI\n           INITIALIZE              MONTHLYI OF CORPT0AI\n                                   YEARLYI  OF CORPT0AI\n                                   CUSTOMI  OF CORPT0AI\n                                   SDTMMI   OF CORPT0AI\n                                   SDTDDI   OF CORPT0AI\n                                   SDTYYYYI OF CORPT0AI\n                                   EDTMMI   OF CORPT0AI\n                                   EDTDDI   OF CORPT0AI\n                                   EDTYYYYI OF CORPT0AI\n                                   CONFIRMI OF CORPT0AI\n"
}]
